(this["webpackJsonpyandex-music-token"]=this["webpackJsonpyandex-music-token"]||[]).push([[0],{21:function(e,t,n){e.exports=n(33)},33:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),o=n.n(c),s=n(18),i=n(11),u=n.n(i),l=n(12),h=n(19),p=n(8),d=n(10),b=n(6),m=n(9),f=n(14),_=(n(27),n(28),n(35)),O=n(38),y=n(36),j=n(37),w=n(39);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(b.a)(t).call(this))).body=e,n}return Object(m.a)(t,e),t}(Object(f.a)(Error)),g=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(b.a)(t).call(this))).body=e,n}return Object(m.a)(t,e),t}(Object(f.a)(Error)),x=function e(){var t=this;Object(p.a)(this,e),this.oauth_url="https://oauth.yandex.ru",this.client_id="23cabbbdc6cd418abb4b39c32c41195d",this.client_secret="53bc75238f0c4d08a118e51fe9203300",this.generate_token_by_username_and_password=function(){var e=Object(h.a)(u.a.mark((function e(n,a,r,c){var o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="".concat(t.oauth_url,"/token"),s={grant_type:"password",client_id:t.client_id,client_secret:t.client_secret,username:n,password:a},r&&c&&(s=E({},s,{x_captcha_answer:r,x_captcha_key:c})),e.next=5,t.post(o,s).then((function(e){return e.json()})).then((function(e){return e.access_token}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),this.serialize=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},this.handleCaptcha=function(e,t){throw e.includes("Wrong")?new g(t):new k(t)},this.post=function(e,n){return fetch(e,{method:"POST",body:t.serialize(n)}).then((function(e){return e.ok?e:e.json().then((function(e){var n=e.error_description||"Unknown HTTP Error";if(n.includes("CAPTCHA"))return t.handleCaptcha(n,e);throw new Error(n)}))}))}},C=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(b.a)(t).call(this,e))).api=new x,n.handleChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(E({},n.state,Object(l.a)({},a,r)))},n.handleSubmit=function(e){e.preventDefault(),n.setState(E({},n.state,{x_captcha_url:void 0,x_captcha_key:void 0}));var t=n.state,a=t.username,r=t.password,c=t.x_captcha_answer,o=t.x_captcha_key;n.api.generate_token_by_username_and_password(a,r,c,o).then((function(e){window.location.href="https://t.me/music_yandex_bot?start=".concat(e)})).catch((function(e){if(e instanceof k||e instanceof g){var t=e.body,a=t.x_captcha_url,r=t.x_captcha_key;n.setState(E({},n.state,{x_captcha_url:a,x_captcha_key:r}))}else alert("An error has occurred: ".concat(e))}))},n.state={username:"",password:""},n}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.x_captcha_url;return r.a.createElement(_.a,null,r.a.createElement(O.a,null,r.a.createElement(O.a.Group,{controlId:"formBasicEmail"},r.a.createElement(O.a.Label,{column:!1},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d, \u043f\u043e\u0447\u0442\u0443 \u0438\u043b\u0438 \u0442\u0435\u043b\u0435\u0444\u043e\u043d:"),r.a.createElement(O.a.Control,{name:"username",onChange:this.handleChange,type:"email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d, \u043f\u043e\u0447\u0442\u0443 \u0438\u043b\u0438 \u0442\u0435\u043b\u0435\u0444\u043e\u043d"})),r.a.createElement(O.a.Group,{controlId:"formBasicPassword"},r.a.createElement(O.a.Label,{column:!1},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement(O.a.Control,{name:"password",onChange:this.handleChange,type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"})),e&&r.a.createElement(y.a,{className:"mb-3"},r.a.createElement(y.a.Prepend,null,r.a.createElement(j.a,{fluid:!0,src:e})),r.a.createElement(O.a.Control,{name:"x_captcha_answer",onChange:this.handleChange,as:"textarea",type:"plain",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u0430\u043f\u0447\u0443"}),r.a.createElement(y.a.Append,null,r.a.createElement(w.a,{type:"submit",onClick:this.handleSubmit},"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"))),r.a.createElement(w.a,{variant:"primary",type:"submit",block:!0,onClick:this.handleSubmit},"\u0412\u043e\u0439\u0442\u0438")))}}]),t}(a.Component);o.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.fb33c39e.chunk.js.map